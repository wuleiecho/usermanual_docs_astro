---
title: 目标检测使用说明
description: Docs intro
layout: ../../layouts/MainLayout.astro
---


## 功能介绍

---

### **简介**

ImageX训练平台支持支持图像分类、目标检测、语义分割三类模型的训练及效果评估，三类模型的功能区别如下：

- 图像分类：按照代表图像整体内容的标签对图像进行分类。适用于图片内容单一、需要给整张图片进行分类的场景
- 目标检测：通常使用矩形框来描述目标位置，任务是找出图像中所有需要检测的目标，确定它们的位置、类别。适合图中有多个主体需要识别、或要识别主体位置及数量的场景。
- 语义分割：是指将图像中的每个像素链接到类标签的过程。适合图中有多个主体、需识别其位置或轮廓的场景

以下是关于目标检测模型的技术文档。

### **应用场景**

- 缺陷检测：如检测产品图像中的缺陷的数量和位置
- 物体检测：如识别和定位生产线上的物体
- 边缘检测：通过对产品图像进行边缘检测，来检测产品的形状和尺寸

### **使用流程**

训练模型的基本流程如下图所示，下面将详细介绍每一步的操作方式和注意事项

![img](/images/目标检测使用说明/1.jpeg)



## 数据准备

### 检测数据标注

---

**标注工具安装**

**Step 1**标注工具分享链接：[https://share.weiyun.com/nOQIR7Kx](https://share.weiyun.com/nOQIR7Kx)

**Step 2**下载安装后启动.exe文件就可以看见界面。

![img](/images/目标检测使用说明/2.png)

启动报错

![img](/images/目标检测使用说明/3.png)

解决办法

进入自己的C:/Users/文件夹中，可以搜索.labelImgSettings.pkl文件，找到后进行删除，然后启动.exe文件可完美解决

**标注步骤**

**Step 1** 启动标注工具labelimg。

**Step 2** 您可以使用Open/OpenDir来处理单个或多个图像。当完成单个图像时，单击菜单栏file-save保存。

![img](/images/目标检测使用说明/4.png)

**Step 3** 在菜单file单击change save dir更改保存标注文件夹

**Step 4** 标注前可点击菜单栏View，勾选Atuo Saving自动保存模式，这样在使用时切换图像会自动将完成标注的图像进行保存。

**Step 5** 在菜单栏Edit点击Create RectBox创建矩形框

![img](/images/目标检测使用说明/5.png)

**Step 6** 单击并释放鼠标左键以选择要注释矩形框的区域

**Step 7** 您可以使用鼠标右键拖动矩形框来复制或移动它

**Step 8** 标注信息文件将保存到您指定的文件夹中。

![img](/images/目标检测使用说明/6.png)

- 默认情况下，常用的快捷键如下：

|                  |                          |
| ---------------- | ------------------------ |
| Ctrl + u         | 从一个目录加载所有的图像 |
| Ctrl + r         | 更改默认注视目标目录     |
| Ctrl + s         | 保存                     |
| Ctrl + d         | 复制当前标签和矩形框     |
| Ctrl + Shift + d | 删除当前图像             |
| Space            | 将当前图像标记为已验证   |
| w                | 创建矩形框               |
| d                | 下一张图像               |
| a                | 上一张图像               |
| del              | 删除所选矩形框           |
| Ctrl++           | 放大                     |
| Ctrl--           | 缩小                     |
| ↑→↓←             | 键盘箭头移动选定矩形框   |



### 数据格式转换

---

标注完成后需将数据格式转换方可上传训练平台开始训练。

**Step 1** 安装anaconda，链接：[https://www.anaconda.com/](https://www.anaconda.com/)

**Step 2** 安装拆分数据集脚本：[https://share.weiyun.com/dvCJKFve](https://share.weiyun.com/dvCJKFve) 下载解压后保存

**Step 3** 打开该文件夹：

![img](/images/目标检测使用说明/7.png)

**Step 4** 在文件夹顶部地址栏输入cmd回车：

![img](/images/目标检测使用说明/8.png)

**Step 5** 输入命令 conda activate base

![img](/images/目标检测使用说明/9.png)

安装出错，可以搜索 windows配置anaconda环境变量

**Step 6** 安装依赖包 pip install pycocotools -i [https://pypi.tuna](https://pypi.tuna/) .tsinghua.edu.cn/simple（已安装可跳过此步骤）：

**Step 7** 根据数据集类型使用命令进行切分（检测）：python dataset_split_code.py --dataset_dir D:/OneDrive/work/Dataset/det_test --task det --val_value 0.2 --test_value 0.0

![img](/images/目标检测使用说明/10.png)

说明：

（1）标注信息文件的存放目录应命名为Annotations，原图像的存放目录应命名为JPEGImages：

![img](/images/目标检测使用说明/11.png)

（2）切分数据前，检查图像名称务必不要出现空格、中文名、括号、点号等。

![img](/images/目标检测使用说明/12.png)

（3）命令中D:/OneDrive/work/Dataset/det_test是存放标注信息文件和原图像的目录，需替换成实际存放标注信息文件和原图像的目录，如示例，我的目录为：F:/furu/shifanjiance）：

![img](/images/目标检测使用说明/13.png)

**Step 8** 数据集划分完成后，也可在目录中查看数据格式转换结果，将数据文件打包上传训练平台就可以训练了！
![img](/images/目标检测使用说明/14.png)


---



### 创建数据集

---

**Step 1** 登录训练平台后，点击侧边栏的【训练任务管理】
![img](/images/目标检测使用说明/15.png)

**Step 2** 点击训练节点下拉框选择相应的训练节点

![img](/images/目标检测使用说明/16.png)

**Step 3** 点击【获取训练节点数据】按钮，获取对应训练节点的数据集列表信息

![img](/images/目标检测使用说明/17.png)

**Step 4** 点击导航栏的【数据集】

![img](/images/目标检测使用说明/18.png)

**Step 5** 点击【新建数据集】按钮

![img](/images/目标检测使用说明/19.png)

**Step 6** 填写相应的数据集信息，并选择数据集类型为【目标检测】（*号为必填项）

![img](/images/目标检测使用说明/20.png)

**Step 7** 确认无误后点击【OK】，这时页面会显示新创建的数据集，且【数据集状态】是【空数据集】

![img](/images/目标检测使用说明/21.png)



### 导入数据集

---

**数据集要求：**

1、导入的训练图片格式仅支持bmp/jpg/png/jpeg，

2、导入的数据压缩包size的最大值为900M；

3、导入的数据压缩包命名仅支持英文、数字、下划线

4、导入的训练数据集内一定要包含labels.txt，train_list.txt和val_list.txt文件，且文件内容不能为空，test_list.txt文件不作要求；

5、导入的训练数据集内单标签分类的⽂件最大数量为5000，图像集合的最⼤数量为20000，分类/检测/分割标签的最大数分别为：1000，80，255；

6、导入数据的时间最多不能超过18分钟，否则数据会上传失败；

**导入数据集步骤：**

**Step 1** 点击【操作】栏下新建数据集一行的【导入】按钮

![img](/images/目标检测使用说明/22.png)

**Step 2** 点击【数据集上传】上传数据集划分后的数据压缩包

![img](/images/目标检测使用说明/23.png)

**Step 3** 等待数据上传结束（具体时间视网速、数据大小而定）

![img](/images/目标检测使用说明/24.png)

**Step 4** 点击【OK】按钮

![img](/images/目标检测使用说明/25.png)

**Step 5** 点击【刷新】按钮，【数据集状态】会由【空数据集】变为【数据集已经切分】

![img](/images/目标检测使用说明/26.png)

![img](/images/目标检测使用说明/27.png)



### 预览数据集

---

**Step 1** 点击【预览】按钮，可查看数据集相关信息（注：只有当【数据集状态】是【数据集已经切分】，才可以点击【预览】按钮，其他状态下【预览】按钮会呈现灰色，无法点击）

![img](/images/目标检测使用说明/28.png)

**Step 2**【预览】页面默认显示的是【全量数据集】和未标注的图片，可通过下拉框选择相应的图片以及勾选【显示标注】来查看标注情况

![img](/images/目标检测使用说明/29.png)

![img](/images/目标检测使用说明/30.png)

**Step 3** 点击【数据集预览】内的图片，每张图片可以放大，缩小，切换上（下）一张

![img](/images/目标检测使用说明/31.png)

**Step 4** 点击【OK】关闭【预览】页面（注：点击【Cancel】、右上角的【X】或页面任一位置都可以关闭【预览】页面）

![img](/images/目标检测使用说明/32.png)





## 模型训练

### 创建训练项目

---

**Step 1** 点击切换到【项目】页面

![img](/images/目标检测使用说明/33.png)

**Step 2** 点击【新建项目】按钮

![img](/images/目标检测使用说明/34.png)

**Step 3** 填写项目信息，项目类型选择【目标检测】，数据集选择已创建的检测数据集（*号为必填项）

![img](/images/目标检测使用说明/35.png)

**Step 4** 确认无误后点击【OK】

![img](/images/目标检测使用说明/36.png)



### 创建训练任务

---

**Step 1** 点击【操作】栏下新增项目一行的【新建任务】按钮

![img](/images/目标检测使用说明/37.png)

**Step 2** 在新建任务弹窗中，设置训练参数（可选择默认参数）

![img](/images/目标检测使用说明/38.png)

**Step 3** 设置完训练参数后，点击右下角【创建并启动训练】按钮

![img](/images/目标检测使用说明/39.png)



### 查看训练状态

---

**Step 1** 点击新建项目左侧的【+】按钮，可以看到任务的训练进度（注：若训练过程中需要暂停，可点击【中止训练】按钮，随后点击【继续训练】按钮可恢复训练）

![img](/images/目标检测使用说明/40.png)

**Step 2** 等待任务训练完成

![img](/images/目标检测使用说明/41.png)





## 模型导出

### 生成推理模型

---

- 任务训练完成后，点击新建任务右侧对应的【导出推理模型】按钮

![img](/images/目标检测使用说明/42.png)

![img](/images/目标检测使用说明/43.png)



### 下载推理模型

---

**Step 1** 点击切换到【模型】页面

![img](/images/目标检测使用说明/44.png)

**Step 2** 点击刚刚导出的模型右侧对应的【下载】按钮

![img](/images/目标检测使用说明/68.png)

![img](/images/目标检测使用说明/45.png)








## 模型测试

### 生成模型评估报告

---

- 任务训练完成后，点击新建任务右侧对应的【评估】按钮

![img](/images/目标检测使用说明/46.png)


![img](/images/目标检测使用说明/47.png)

### 下载模型评估报告

---

- 点击新建任务右侧的【下载评估报告】按钮

![img](/images/目标检测使用说明/48.png)

![img](/images/目标检测使用说明/49.png)

### 模型单图测试

---

**图片要求：**

导入的测试图片格式仅支持bmp/jpg/png/jpeg/tif，其他图片格式不支持。

**单图测试步骤：**

**Step 1** 点击刚刚导出的模型右侧对应的【单图测试】按钮

![img](/images/目标检测使用说明/50.png)

![img](/images/目标检测使用说明/51.png)

**Step 2** 点击【upload】按钮，上传所需预测的图片（注：图片格式为bmp/jpg/png/jpeg/tif，若多次上传，则仅保留最后一次上传的图片）

![img](/images/目标检测使用说明/52.png)

**Step 3** 点击上传后的图片，可放大显示

![img](/images/目标检测使用说明/53.png)

**Step 4** 点击【预测】按钮，显示正在预测中

![img](/images/目标检测使用说明/54.png)

**Step 5** 等待预测完成

![img](/images/目标检测使用说明/55.png)

**Step 6** 点击图片，可放大查看预测结果图片

![img](/images/目标检测使用说明/56.png)

**Step 7** 点击【下载】按钮，下载预测结果图片

![img](/images/目标检测使用说明/57.png)

![img](/images/目标检测使用说明/58.png)

**Step 8** 点击【取消】按钮，关闭【单图测试】页面，返回到【模型】页面

![img](/images/目标检测使用说明/59.png)



### 模型批量测试

---

**数据要求：**

1、导入的测试图片格式仅支持bmp/jpg/png/jpeg/tif，其他图片格式不支持

2、导入的数据压缩包size的最大值为900M

3、导入的数据压缩包命名仅支持英文、数字、下划线

4、导入数据的时间最多不能超过18分钟，否则数据会上传失败

1、导入的测试图片格式仅支持bmp/jpg/png/jpeg/tif，其他图片格式不支持

2、导入的数据压缩包size的最大值为900M

3、导入的数据压缩包命名仅支持英文、数字、下划线

4、导入数据的时间最多不能超过18分钟，否则数据会上传失败

**批量测试步骤：**

**Step 1** 点击刚刚导出的模型右侧对应的【批量测试】按钮

![img](/images/目标检测使用说明/60.png)

![img](/images/目标检测使用说明/61.png)

**Step 2** 点击【upload】按钮上传需要测试的zip文件（注：若多次上传，则仅保留最后一次上传的文件）

![img](/images/目标检测使用说明/62.png)

**Step 3** 等待上传结束

![img](/images/目标检测使用说明/63.png)

**Step 4** 点击【批量图预测】按钮

![img](/images/目标检测使用说明/64.png)

![img](/images/目标检测使用说明/65.png)

**Step 5** 点击【下载】按钮，等待一会

![img](/images/目标检测使用说明/66.png)

![img](/images/目标检测使用说明/69.png)

**Step 6** 点击【取消】按钮，关闭【批量测试】页面，返回到【模型】页面

![img](/images/目标检测使用说明/67.png)